<!DOCTYPE html>
<!-- saved from url=(0058)https://docker-runner.docs.drone.io/configuration/cloning/ -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Cloning | Drone</title>


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="copyright" content="">

<link rel="icon" type="image/png" sizes="32x32" href="https://docker-runner.docs.drone.io/favicon.png">
<link rel="stylesheet" href="./Cloning _ Drone_files/docsearch.min.css">
<link rel="stylesheet" href="./Cloning _ Drone_files/style.css">
<link rel="stylesheet" href="./Cloning _ Drone_files/css">





  </head>
  <body>
        <header class="header">
        <div class="branding">
            <button class="menu" aria-hidden="true"></button>
            <a class="logo" href="https://docker-runner.docs.drone.io/" aria-label="Documentation">
                <img src="./Cloning _ Drone_files/logo.svg">
            </a>
        </div>
        <div class="search">
            <span class="algolia-autocomplete" style="position: relative; display: inline-block; direction: ltr;"><input type="text" class="aa-hint" readonly="" aria-hidden="true" autocomplete="off" spellcheck="false" tabindex="-1" style="position: absolute; top: 0px; left: 0px; border-color: transparent; box-shadow: none; opacity: 1; background: none 0% 0% / auto repeat scroll padding-box border-box rgba(255, 255, 255, 0.1);"><input type="text" id="search-input" placeholder="Search the Drone Docker Runner documentation ..." class="aa-input" autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="both" aria-expanded="false" aria-owns="algolia-autocomplete-listbox-0" dir="auto" style="position: relative; vertical-align: top; background-color: transparent;"><pre aria-hidden="true" style="position: absolute; visibility: hidden; white-space: pre; font-family: system-ui; font-size: 15px; font-style: normal; font-variant: normal; font-weight: 400; word-spacing: 0px; letter-spacing: normal; text-indent: 0px; text-rendering: auto; text-transform: none;"></pre><span class="aa-dropdown-menu" role="listbox" id="algolia-autocomplete-listbox-0" style="position: absolute; top: 100%; z-index: 100; display: none; left: 0px; right: auto;"><div class="aa-dataset-1"></div></span></span>
        </div>
    </header>
    <section class="sidebar">
    <header aria-hidden="true">
        <button class="close"></button>
    </header>
    <div class="back">
        <a href="https://docs.drone.io/">Main Documentation</a>
    </div>
    <div class="title">
        <a href="https://docker-runner.docs.drone.io/">Docker runner</a>
    </div>
    





<nav class="tree">

    <ul>
    
    

    

    

    
    <li>
        <details>
            <summary>
                <a href="https://docker-runner.docs.drone.io/installation/">Installation</a>
            </summary>
            <ul>
            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/installation/install_linux/">Install on Linux</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/installation/install_windows/">Install on Windows</a>
    </li>
    

            

            
            
    

    

    
    <li class="hide_children">
        <a href="https://docker-runner.docs.drone.io/installation/reference/">Configuration Reference</a>
    </li>
    

            
            </ul>
        </details>
    </li>
    

    </ul>
    
    <ul>
    
    

    

    

    
    <li>
        <details open="">
            <summary>
                <a href="https://docker-runner.docs.drone.io/configuration/">Configuration</a>
            </summary>
            <ul>
            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/overview/">Overview</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/trigger/">Triggers</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/platform/">Platform</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/workspace/">Workspace</a>
    </li>
    

            
            
    

    

    
    <li class="selected active">
        <a href="https://docker-runner.docs.drone.io/configuration/cloning/">Cloning</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/steps/">Steps</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/plugins/">Plugins</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/services/">Services</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/images/">Images</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/parallelism/">Parallelism</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/conditions/">Conditions</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/routing/">Routing</a>
    </li>
    

            

            
            
    

    

    

    
    <li>
        <details>
            <summary>
                <a href="https://docker-runner.docs.drone.io/configuration/environment/">Environment</a>
            </summary>
            <ul>
            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/environment/overview/">Environment</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/environment/substitution/">Substitution</a>
    </li>
    

            

            
            
    

    

    
    <li class="hide_children">
        <a href="https://docker-runner.docs.drone.io/configuration/environment/variables/">Environment Reference</a>
    </li>
    

            
            </ul>
        </details>
    </li>
    

            
            
    

    

    

    
    <li>
        <details>
            <summary>
                <a href="https://docker-runner.docs.drone.io/configuration/volumes/">Volumes</a>
            </summary>
            <ul>
            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/volumes/host/">Host Volumes</a>
    </li>
    

            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/configuration/volumes/temporary/">Temporary Volumes</a>
    </li>
    

            

            
            </ul>
        </details>
    </li>
    

            
            </ul>
        </details>
    </li>
    

    </ul>
    
    <ul>
    
    

    

    
    <li class="hide_children">
        <a href="https://docker-runner.docs.drone.io/specification/">Specification</a>
    </li>
    

    </ul>
    
    <ul>
    
    

    

    

    
    <li>
        <details>
            <summary>
                <a href="https://docker-runner.docs.drone.io/examples/">Examples</a>
            </summary>
            <ul>
            

            
            
    

    

    
    <li class="hide_children">
        <a href="https://docker-runner.docs.drone.io/examples/language/">Languages</a>
    </li>
    

            
            
    

    

    
    <li class="hide_children">
        <a href="https://docker-runner.docs.drone.io/examples/service/">Services</a>
    </li>
    

            
            </ul>
        </details>
    </li>
    

    </ul>
    
    <ul>
    
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/support/">Support</a>
    </li>
    

    </ul>
    
    <ul>
    
    

    

    

    
    <li>
        <details>
            <summary>
                <a href="https://docker-runner.docs.drone.io/questions/">Questions</a>
            </summary>
            <ul>
            
            
    

    

    
    <li>
        <a href="https://docker-runner.docs.drone.io/questions/usage/how-to-limit-concurrency/"></a>
    </li>
    

            

            
            </ul>
        </details>
    </li>
    

    </ul>
    
</nav>

</section>

    <main>
        <article>
            <header>
                <div class="breadcrumb">
    <div class="crumb">
        <a href="https://docker-runner.docs.drone.io/">Docker runner</a>
    </div>
    
        <div class="crumb">
            <a href="https://docker-runner.docs.drone.io/configuration/">Configuration</a>
        </div>
        
</div>

                <h1>Cloning</h1>
            </header>
            <section class="content">

<p>Drone automatically clones your repository before executing your pipeline steps. No special configuration is required. In some cases, however, you may need to customize, override or disable the default clone behavior.</p>

<h1 id="the-depth-flag">The <code>--depth</code> flag</h1>

<p>The default clone configuration does use the <code>--depth</code> flag. You can enforce a clone depth by declaring a <code>clone</code> block and adding the <code>depth</code> attribute:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tbody><tr><td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="hl"><span class="lnt"> 5
</span></span><span class="hl"><span class="lnt"> 6
</span></span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">kind: pipeline
type: docker
name: default

<span class="hl">clone:
</span><span class="hl">  depth: 50
</span>
steps:
- name: build
  commands:
  - go build
  - go test</code></pre></td></tr></tbody></table>
</div>
</div>

<h1 id="the-tags-flag">The <code>--tags</code> flag</h1>

<p>The default clone configuration does not use the <code>--tags</code> flag. If you would like to fetch tags you should handle this as a step in your pipeline. For example:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tbody><tr><td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="hl"><span class="lnt"> 6
</span></span><span class="hl"><span class="lnt"> 7
</span></span><span class="hl"><span class="lnt"> 8
</span></span><span class="hl"><span class="lnt"> 9
</span></span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">kind: pipeline
type: docker
name: default

steps:
<span class="hl">- name: fetch
</span><span class="hl">  image: alpine:git
</span><span class="hl">  commands:
</span><span class="hl">  - git fetch --tags
</span>
- name: build
  commands:
  - go build
  - go test</code></pre></td></tr></tbody></table>
</div>
</div>

<h1 id="the-recursive-flag">The <code>--recursive</code> flag</h1>

<p>The default clone behavior does not use the <code>--recursive</code> flag and does not fetch submodules. If you would like to fetch submodules you should handle this as a step in your pipeline. For example:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tbody><tr><td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="hl"><span class="lnt"> 6
</span></span><span class="hl"><span class="lnt"> 7
</span></span><span class="hl"><span class="lnt"> 8
</span></span><span class="hl"><span class="lnt"> 9
</span></span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">kind: pipeline
type: docker
name: default

steps:
<span class="hl">- name: submodules
</span><span class="hl">  image: alpine:git
</span><span class="hl">  commands:
</span><span class="hl">  - git submodule update --recursive --remote
</span>
- name: build
  commands:
  - go build
  - go test</code></pre></td></tr></tbody></table>
</div>
</div>

<h1 id="custom-logic">Custom Logic</h1>

<p>The default clone behavior can be disabled and custom clone logic implemented, when necessary. In the following example we implement custom clone commands as a pipeline step:</p>

<div class="highlight"><div class="chroma">
<table class="lntable"><tbody><tr><td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text"><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="hl"><span class="lnt"> 5
</span></span><span class="hl"><span class="lnt"> 6
</span></span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="hl"><span class="lnt"> 9
</span></span><span class="hl"><span class="lnt">10
</span></span><span class="hl"><span class="lnt">11
</span></span><span class="hl"><span class="lnt">12
</span></span><span class="hl"><span class="lnt">13
</span></span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-text" data-lang="text">kind: pipeline
type: docker
name: default

<span class="hl">clone:
</span><span class="hl">  disable: true
</span>
steps:
<span class="hl">- name: clone
</span><span class="hl">  image: alpine:git
</span><span class="hl">  commands:
</span><span class="hl">  - git clone https://github.com/octocat/hello-world.git .
</span><span class="hl">  - git checkout $DRONE_COMMIT
</span>
- name: build
  commands:
  - go build
  - go test</code></pre></td></tr></tbody></table>
</div>
</div>
</section>
            <footer class="next-prev">
    
    <a href="https://docker-runner.docs.drone.io/configuration/workspace/" class="prev">
        <span class="icon"></span>
        <span class="type">Previous</span>
        <span class="name">Workspace</span>
    </a>
    

    
    <a href="https://docker-runner.docs.drone.io/configuration/steps/" class="next">
        <span class="type">Next</span>
        <span class="name">Steps</span>
        <span class="icon"></span>
    </a>
    
</footer>
        </article>

        <aside>
    
    <nav class="table-of-contents">
        <header>Contents</header>
        <nav id="TableOfContents">
<ul>
<li><a href="https://docker-runner.docs.drone.io/configuration/cloning/#the-depth-flag">The <code>--depth</code> flag</a></li>
<li><a href="https://docker-runner.docs.drone.io/configuration/cloning/#the-tags-flag">The <code>--tags</code> flag</a></li>
<li><a href="https://docker-runner.docs.drone.io/configuration/cloning/#the-recursive-flag">The <code>--recursive</code> flag</a></li>
<li><a href="https://docker-runner.docs.drone.io/configuration/cloning/#custom-logic">Custom Logic</a></li>
</ul>
</nav>
    </nav>
    
</aside>
    </main>
    
<div class="overlay" aria-hidden="true"></div>


<script>
    function toggle(el) {
        if (el.classList.contains("open")) {
            el.classList.remove("open");
        } else {
            el.classList.add("open");
        }
    };
    function toggleSidebar(e) {
        toggle(document.querySelector(".sidebar"));
        toggle(document.querySelector(".overlay"));
    }
    document.querySelector(".overlay").addEventListener("click", toggleSidebar);
    document.querySelector("header .menu").addEventListener("click", toggleSidebar);
    document.querySelector(".sidebar header button").addEventListener("click", toggleSidebar);
</script>


<script src="./Cloning _ Drone_files/autocomplete.js"></script>
<script src="./Cloning _ Drone_files/fuse.js"></script>
<script>
var options = {
  shouldSort: true,
  tokenize: false,
  threshold: 0.6,
  location: 0,
  distance: 100,
  maxPatternLength: 32,
  minMatchCharLength: 1,
  keys: [
    "title",
    "tags",
    "content"
  ]
};

var index;
autocomplete('#search-input', {
    hint: true,
    debounce: 250,
    cache: true,
    debug: window.location.hostname === "localhost",
}, [
    {
        displayKey: function(suggestion) {
            return suggestion.title
        },
        source: function(query, callback) {
            if (!index) {
                fetch("/index.json")
                .then(function(response) {
                    return response.json();
                })
                .then(function(items) {
                    index = new Fuse(items, options);
                    var results = index.search(query);
                    callback(results && results.slice(0, 5));
                });
            } else {
                var results = index.search(query);
                callback(results && results.slice(0, 5));
            }
        }
    }]).on('autocomplete:selected', function(event, suggestion, dataset) {
        window.location.href = suggestion.permalink;
    });
</script>

  

</body></html>